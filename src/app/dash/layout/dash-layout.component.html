<!-- Alerta de actualización de plan -->
<plan-upgrade-alert 
  [planInfo]="planInfo" 
  [show]="showPlanAlert"
  (upgrade)="onPlanUpgrade()"
  (dismiss)="onPlanAlertDismiss()">
</plan-upgrade-alert>

<div class="dash-layout" [class.sidebar-collapsed]="isCollapsed">
  <aside class="sidebar" [class.collapsed]="isCollapsed">
    <div class="rail">
      <button class="rail-toggle" (click)="isCollapsed = !isCollapsed" title="Contraer/Expandir">
        <ui-icon [name]="isCollapsed ? 'chevron-right' : 'chevron-left'" [size]="18"></ui-icon>
      </button>
      <a class="rail-item" routerLink="/dash/home" routerLinkActive="active" title="Inicio" (click)="onNav()"><ui-icon name="home" [size]="20"></ui-icon></a>
      <a class="rail-item" routerLink="/dash/agenda" routerLinkActive="active" title="Agenda" (click)="onNav()"><ui-icon name="calendar" [size]="20"></ui-icon></a>
      <a class="rail-item" routerLink="/dash/ingresos" routerLinkActive="active" title="Ingresos" (click)="onNav()"><ui-icon name="money" [size]="20"></ui-icon></a>
      <a class="rail-item" routerLink="/dash/estadisticas" routerLinkActive="active" title="Estadísticas" (click)="onNav()"><ui-icon name="chart" [size]="20"></ui-icon></a>
      <a class="rail-item" routerLink="/dash/promocion" routerLinkActive="active" title="Promoción" (click)="onNav()"><ui-icon name="star" [size]="20"></ui-icon></a>
      <a class="rail-item" routerLink="/dash/mensajes" routerLinkActive="active" title="Mensajes" (click)="onNav()"><ui-icon name="message" [size]="20"></ui-icon></a>
      <a class="rail-item" routerLink="/dash/servicios" routerLinkActive="active" title="Servicios" (click)="onNav()"><ui-icon name="briefcase" [size]="20"></ui-icon></a>
      <a class="rail-item" routerLink="/dash/perfil" routerLinkActive="active" title="Perfil" (click)="onNav()"><ui-icon name="user" [size]="20"></ui-icon></a>
      <div class="spacer"></div>
      <a class="rail-item" (click)="logout()" title="Salir" style="cursor: pointer;"><ui-icon name="logout" [size]="20"></ui-icon></a>
    </div>
    <div class="panel elevated">
      <div class="user-summary">
        <div style="position: relative; display: inline-block;">
          <img class="avatar" [src]="providerAvatarUrl || '/assets/default-avatar.png'" alt="Avatar" (error)="onAvatarError($event)" />
          <span class="status-dot" [class.online]="isOnline === true" [class.offline]="isOnline === false"></span>
        </div>
        <div class="user-info">
          <div class="user-name">{{ providerName || 'Usuario' }}</div>
          <div class="user-sub">Cuenta de profesional</div>
        </div>
      </div>
      <nav class="menu">
        <a routerLink="/dash/home" routerLinkActive="active" (click)="onNav()"><ui-icon name="home"></ui-icon><span>Inicio</span></a>
        <a routerLink="/dash/agenda" routerLinkActive="active" (click)="onNav()"><ui-icon name="calendar"></ui-icon><span>Agenda</span></a>
        <a routerLink="/dash/ingresos" routerLinkActive="active" (click)="onNav()"><ui-icon name="money"></ui-icon><span>Ingresos</span></a>
        <a routerLink="/dash/estadisticas" routerLinkActive="active" (click)="onNav()"><ui-icon name="chart"></ui-icon><span>Estadísticas</span></a>
        <a routerLink="/dash/mensajes" routerLinkActive="active" (click)="onNav()"><ui-icon name="message"></ui-icon><span>Mensajes</span></a>
        <a routerLink="/dash/servicios" routerLinkActive="active" (click)="onNav()"><ui-icon name="briefcase"></ui-icon><span>Mis Servicios</span></a>
        <a routerLink="/dash/promocion" routerLinkActive="active" (click)="onNav()"><ui-icon name="star"></ui-icon><span>Promoción</span></a>
        <a routerLink="/dash/perfil" routerLinkActive="active" (click)="onNav()"><ui-icon name="user"></ui-icon><span>Mi Perfil</span></a>
      </nav>
      <div class="footer">
        <a routerLink="/dash/terminos" class="footer-link" (click)="onNav()">Términos y Condiciones</a>
        <theme-switch size="sm"></theme-switch>
      </div>
    </div>
  </aside>
  <main class="content">
    <app-topbar 
      [config]="topbarConfig"
      (hamburgerClick)="isCollapsed = !isCollapsed"
      (helpClick)="onHelpClick($event)"
      (notificationClick)="onNotificationClick()"
      (settingsClick)="onSettingsClick()">
    </app-topbar>
    <div class="main-slot">
      <router-outlet></router-outlet>
    </div>
  </main>
</div>
