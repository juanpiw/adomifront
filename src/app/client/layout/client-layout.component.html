<div class="client-layout" [class.sidebar-collapsed]="isCollapsed">
  <aside class="sidebar" [class.collapsed]="isCollapsed">
    <!-- Rail Menu (siempre visible) -->
    <div class="rail">
      <button class="rail-toggle" (click)="isCollapsed = !isCollapsed" title="Contraer/Expandir">
        <ui-icon [name]="isCollapsed ? 'chevron-right' : 'chevron-left'" [size]="16"></ui-icon>
      </button>
      <a class="rail-item" routerLink="/client/explorar" routerLinkActive="active" title="Explorar" (click)="onNav()">
        <ui-icon name="search" [size]="18"></ui-icon>
      </a>
      <a class="rail-item" routerLink="/client/reservas" routerLinkActive="active" title="Mis Reservas" (click)="onNav()">
        <ui-icon name="calendar" [size]="18"></ui-icon>
      </a>
              <a class="rail-item" routerLink="/client/favoritos" routerLinkActive="active" title="Favoritos" (click)="onNav()">
                <ui-icon name="heart" [size]="18"></ui-icon>
              </a>
              <a class="rail-item" routerLink="/client/conversaciones" routerLinkActive="active" title="Conversaciones" (click)="onNav()">
                <ui-icon name="message" [size]="18"></ui-icon>
              </a>
              <a class="rail-item" routerLink="/client/perfil" routerLinkActive="active" title="Mi Perfil" (click)="onNav()">
                <ui-icon name="user" [size]="18"></ui-icon>
              </a>
      <a class="rail-item" routerLink="/client/pagos" routerLinkActive="active" title="Métodos de Pago" (click)="onNav()">
        <ui-icon name="card" [size]="18"></ui-icon>
      </a>
      <a class="rail-item" routerLink="/client/configuracion" routerLinkActive="active" title="Configuración" (click)="onNav()">
        <ui-icon name="settings" [size]="18"></ui-icon>
      </a>
      <div class="spacer"></div>
      <a class="rail-item" (click)="logout()" title="Salir" style="cursor: pointer;">
        <ui-icon name="logout" [size]="18"></ui-icon>
      </a>
    </div>
    
    <!-- Panel (solo visible cuando no está colapsado) -->
    <div class="panel" *ngIf="!isCollapsed">
      <div class="user-summary">
        <img class="avatar" [src]="userAvatarUrl || '/assets/default-avatar.png'" alt="Avatar" (error)="onAvatarError($event)" />
        <div class="user-info">
          <div class="user-name">{{ userName || 'Usuario' }}</div>
          <div class="user-sub">Cuenta de cliente</div>
        </div>
      </div>
      <nav class="menu">
        <a routerLink="/client/explorar" routerLinkActive="active" (click)="onNav()">
          <ui-icon name="search" [size]="16"></ui-icon><span>Explorar</span>
        </a>
        <a routerLink="/client/reservas" routerLinkActive="active" (click)="onNav()">
          <ui-icon name="calendar" [size]="16"></ui-icon><span>Mis Reservas</span>
        </a>
                <a routerLink="/client/favoritos" routerLinkActive="active" (click)="onNav()">
                  <ui-icon name="heart" [size]="16"></ui-icon><span>Favoritos</span>
                </a>
                <a routerLink="/client/conversaciones" routerLinkActive="active" (click)="onNav()">
                  <ui-icon name="message" [size]="16"></ui-icon><span>Conversaciones</span>
                </a>
                <a routerLink="/client/perfil" routerLinkActive="active" (click)="onNav()">
                  <ui-icon name="user" [size]="16"></ui-icon><span>Mi Perfil</span>
                </a>
        <a routerLink="/client/pagos" routerLinkActive="active" (click)="onNav()">
          <ui-icon name="card" [size]="16"></ui-icon><span>Métodos de Pago</span>
        </a>
        <a routerLink="/client/configuracion" routerLinkActive="active" (click)="onNav()">
          <ui-icon name="settings" [size]="16"></ui-icon><span>Configuración</span>
        </a>
      </nav>
      <div class="footer">
        <a routerLink="/client/terminos" class="footer-link" (click)="onNav()">Términos y Condiciones</a>
        <theme-switch size="sm"></theme-switch>
        <a (click)="logout()" class="logout" style="cursor: pointer;">Salir</a>
      </div>
    </div>
  </aside>
  
  <!-- Overlay para móvil - después del sidebar para que no bloquee -->
  <div *ngIf="!isCollapsed && isMobile()" class="sidebar-overlay" (click)="isCollapsed = true; menuService.closeMenu()"></div>
  
  <main class="content">
    <app-topbar 
      [config]="topbarConfig"
      (hamburgerClick)="isCollapsed = !isCollapsed"
      (helpClick)="onHelpClick($event)"
      (notificationClick)="onNotificationClick()"
      (settingsClick)="onSettingsClick()">
    </app-topbar>
    <div class="main-slot">
      <router-outlet></router-outlet>
    </div>
  </main>
</div>
