<section class="mis-servicios">
  <h3 class="mis-servicios__title">Mis Servicios</h3>
  <p class="mis-servicios__subtitle">
    Define los servicios que ofreces, su duración y precio. Esto es lo que tus clientes podrán agendar.
  </p>
  
  <div class="mis-servicios__list">
    <!-- Lista de servicios existentes -->
    <div *ngFor="let service of services; trackBy: trackByServiceId" class="mis-servicios__item">
      <div class="mis-servicios__item-content">
        <!-- Imagen del servicio -->
        <div class="mis-servicios__item-image">
          <img 
            *ngIf="service.service_image_url" 
            [src]="service.service_image_url" 
            [alt]="service.name"
            class="mis-servicios__image">
          <div *ngIf="!service.service_image_url" class="mis-servicios__image-placeholder">
            <svg class="mis-servicios__placeholder-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
            </svg>
          </div>
        </div>

        <!-- Información del servicio -->
        <div class="mis-servicios__item-info">
          <div class="mis-servicios__item-header">
            <h4 class="mis-servicios__item-name">{{ service.name }}</h4>
            <div class="mis-servicios__item-badges">
              <span *ngIf="service.is_featured" class="mis-servicios__badge mis-servicios__badge--featured">
                ⭐ Destacado
              </span>
              <span *ngIf="!service.is_active" class="mis-servicios__badge mis-servicios__badge--inactive">
                ⏸️ Inactivo
              </span>
            </div>
          </div>
          
          <p class="mis-servicios__item-category">{{ getCategoryName(service) }} - {{ getSubcategoryName(service) }}</p>
          <p class="mis-servicios__item-description">{{ service.description }}</p>
          
          <div class="mis-servicios__item-details">
            <span class="mis-servicios__detail">
              <svg class="mis-servicios__detail-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              {{ formatDuration(service.duration_minutes) }}
            </span>
            <span class="mis-servicios__detail">
              <svg class="mis-servicios__detail-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
              </svg>
              {{ formatPrice(service.price) }}
            </span>
            <span *ngIf="service.booking_count > 0" class="mis-servicios__detail">
              <svg class="mis-servicios__detail-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
              </svg>
              {{ service.booking_count }} reserva{{ service.booking_count !== 1 ? 's' : '' }}
            </span>
          </div>
        </div>

        <!-- Acciones del servicio -->
        <div class="mis-servicios__item-actions">
          <button 
            class="mis-servicios__action-btn mis-servicios__action-btn--edit"
            (click)="onEditService(service)"
            title="Editar servicio">
            <svg class="mis-servicios__action-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
            </svg>
            Editar
          </button>
          <button 
            class="mis-servicios__action-btn mis-servicios__action-btn--delete"
            (click)="onDeleteService(service.id)"
            title="Eliminar servicio">
            <svg class="mis-servicios__action-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
            </svg>
            Eliminar
          </button>
        </div>
      </div>
    </div>

    <!-- Estado vacío -->
    <div *ngIf="services.length === 0 && !loading" class="mis-servicios__empty">
      <div class="mis-servicios__empty-icon">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
        </svg>
      </div>
      <h4 class="mis-servicios__empty-title">No tienes servicios aún</h4>
      <p class="mis-servicios__empty-description">
        Crea tu primer servicio para que los clientes puedan agendar citas contigo.
      </p>
    </div>

    <!-- Estado de carga -->
    <div *ngIf="loading" class="mis-servicios__loading">
      <div class="mis-servicios__loading-spinner"></div>
      <p class="mis-servicios__loading-text">Cargando servicios...</p>
    </div>

    <!-- Botón para agregar nuevo servicio -->
    <button 
      *ngIf="services.length < 10"
      class="mis-servicios__add-button"
      (click)="onAddNewService()">
      <svg class="mis-servicios__add-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
      </svg>
      Añadir nuevo servicio
    </button>

    <!-- Mensaje de límite alcanzado -->
    <div *ngIf="services.length >= 10" class="mis-servicios__limit-message">
      <p class="mis-servicios__limit-text">
        Has alcanzado el límite máximo de 10 servicios.
      </p>
    </div>
  </div>

  <!-- Modal de crear/editar servicio -->
  <app-modal-crear-servicio
    [isOpen]="showCreateModal"
    [editingService]="editingService"
    (close)="onCloseModal()"
    (save)="onSaveService($event)">
  </app-modal-crear-servicio>

  <!-- Modal de confirmación para eliminar servicio -->
  <app-modal-confirmacion
    [isOpen]="showDeleteModal"
    [loading]="deletingService"
    type="danger"
    title="Eliminar Servicio"
    [message]="'¿Estás seguro de que deseas eliminar este servicio? Esta acción no se puede deshacer.'"
    confirmText="Eliminar"
    cancelText="Cancelar"
    (confirm)="onConfirmDelete()"
    (cancel)="onCancelDelete()">
  </app-modal-confirmacion>
</section>