<div class="referral-card custom-shadow">
  <div class="referral-icon">
    <div class="referral-icon__circle">
      <ui-icon name="user-plus" class="w-10 h-10 text-indigo-600"></ui-icon>
    </div>
  </div>

  <h3 class="referral-title">
    No encontramos a nadie... todavía
  </h3>
  <p class="referral-subtitle">
    No hay profesionales disponibles para "<span>{{ searchTerm || 'este servicio' }}</span>"{{ locationLabel ? (' en ' + locationLabel) : '' }}.
  </p>

  <div class="referral-content">
    <h4>¿Conoces a alguien que imparta este servicio?</h4>
    <p class="referral-description">
      ¡Invítalo a AdomiApp y ayúdanos a crecer nuestra comunidad de profesionales!
    </p>

    <div class="referral-actions">
      <button
        class="referral-btn referral-btn--whatsapp"
        (click)="onWhatsappClick()"
        [disabled]="shareDisabled || loadingChannel === 'whatsapp'">
        <span class="btn-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>
        </span>
        <span>{{ loadingChannel === 'whatsapp' ? 'Abriendo...' : 'Invitar por WhatsApp' }}</span>
      </button>

      <button
        class="referral-btn referral-btn--email"
        (click)="toggleEmail()"
        [disabled]="shareDisabled">
        <ui-icon name="mail" class="w-5 h-5"></ui-icon>
        <span>Invitar por Email</span>
      </button>
    </div>

    <div class="referral-email" *ngIf="emailVisible">
      <label for="referral-email-input">Correo electrónico</label>
      <input
        id="referral-email-input"
        type="email"
        [(ngModel)]="emailValue"
        placeholder="nombre@ejemplo.com"
        [disabled]="loadingChannel === 'email'"
      />
      <p class="referral-email__error" *ngIf="emailError">{{ emailError }}</p>
      <div class="referral-email__actions">
        <button class="referral-btn referral-btn--primary" (click)="submitEmail()" [disabled]="loadingChannel === 'email'">
          <span *ngIf="loadingChannel === 'email'">Enviando...</span>
          <span *ngIf="loadingChannel !== 'email'">Enviar invitación</span>
        </button>
        <button class="referral-btn" (click)="toggleEmail()" type="button">Cancelar</button>
      </div>
    </div>

    <button
      class="referral-btn referral-btn--copy"
      (click)="onCopyClick()"
      [disabled]="shareDisabled || loadingChannel === 'copy'">
      <ui-icon name="copy" class="w-4 h-4"></ui-icon>
      <span>{{ loadingChannel === 'copy' ? 'Copiando...' : 'Copiar Enlace de Invitación' }}</span>
    </button>

    <div class="referral-copy-feedback" *ngIf="copyFeedback">
      ¡Enlace copiado! Compártelo con tus contactos.
    </div>
  </div>
</div>

